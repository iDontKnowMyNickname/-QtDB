# QtDB
QtDB - простая программа для чтения, записи данных в PostgreSQL с помощью графического интерфейса Qt.

В первую очередь, создается GitHub-репозиторий для сохранения изменений. GitHub проект создается с .gitignore по шаблону Qt, чтобы не включать в себя лишней информации.  
Создается ветка testing0 для внесения первичных изменений. Ветка main будет содержать окончательно оформленные компоненты программы.  
Следующий шаг - создание проекта Qt. Нужно убедиться, что проект можно загрузить с GitHub и скомпилировать. Если же нет, необходимо внести правки в .gitignore.  
Создадим проект QtDB и убедимся в его работоспособности: должно открываться пустое окно. Сделаем commit и добавим проект в репозиторий. После этого попробуем загрузить его, например, на Windows, и открыть проект там.  

В результате эксперимента архив репозитория был загружен, проект успешно запущен (пришлось только сменить набор (kit) Qt).

# Описание проекта

Теперь, когда заготовка создана, опишем техническое задание к проекту.

Проект представляет собой программу на языке программирования C++, созданную с использованием фреймворка Qt.
Программа должна взаимодействовать с базой данных PostgreSQL и иметь интерфейс, позволяющий добавлять, просматривать и удалять записи в базе данных.

База данных должна содержать две связанные таблицы:
1. Содержит сведения о владельцах автомобилей;
2. Содержит сведения об автомобилях.

База может содержать любые параметры, желательно до 10.

# Перечень рассматриваемых задач

В связи с предоставляемой заданием свободой действий разработке подлежат:

- Архитектура системы
  - Разделение программы на компоненты
  - Желательно обеспечить максимальную простоту внесения изменений при необходимости

- Архитектура базы данных
  - Для каждой таблицы нужно определить количество атрибутов
    - для каждого атрибута нужно определить и настроить тип хранимого в нем значения
  - Нужно определить тип связи между таблицами
  - Нужно разграничить права доступа (в PostgreSQL это называется *роли*)
    - Желательно выделить в отдельную категорию права на чтение
    - Желательно выделить в отдельную категорию права на удаление
    - Желательно выделить в отдельную категорию права на запись
  - Ввести механизмы для защиты от атаки [**SQL-инъекция**](https://www.ptsecurity.com/ru-ru/research/analytics/cybersecurity-threatscape-2023-q2/#:~:text=CVE%2D2023%2D34362.%20%D0%A8%D0%B8%D1%80%D0%BE%D0%BA%D0%BE,%D0%B2%20%D0%B7%D0%B0%D0%BF%D1%80%D0%BE%D1%81%D1%8B%20%D0%BA%20%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D1%83. "Positive Technologies. Актуальные уязвимости за II квартал 2023 года")

- Расположение элементов графического интерфейса
  - Продумать вид и функционал интерфейса чтения
    - нужно ограничить количество выводимых на экран элементов для уменьшения потребления оперативной памяти на элементы Qt-таблицы
  - Продумать вид интерфейса записи
    - убедиться, что при вводе SQL-кода ничего не произойдет
  - Продумать вид интерфейса удаления
    - убедиться, что при вводе SQL-кода ничего не произойдет

Поставив задачи, можно приступить к рассмотрению отдельно каждого пункта.

# Реализация компонентов программы

## Архитектура программы

*вставить текст*

## Архитектура базы данных

Перед началом проектирования базы данных установим и настроим необходимые инструменты.
Установим PostgreSQL-all на Ubuntu WSL, pgAdmin 4 на хост-Windows.

Создадим суперпользователя, от имени которого будем настраивать базу и работать с pgAdmin 4.

В терминале WSL:

```
# Запуск утилиты **psql**, которая осуществляет управление PostgreSQL, от имени главного пользователя **postgres**
romanb@DESKTOP-E2A6Q9E:~/QtProjects/GitHub/QtDB$ sudo -u postgres psql
[sudo] password for romanb:
could not change directory to "/home/romanb/QtProjects/GitHub/QtDB": Permission denied
psql (14.11 (Ubuntu 14.11-0ubuntu0.22.04.1))
Type "help" for help.

postgres=# CREATE ROLE Capybara PASSWORD 'IamCapybara' SUPERUSER CREATEDB CREATEROLE INHERIT LOGIN;
CREATE ROLE
postgres=# \q
romanb@DESKTOP-E2A6Q9E:~/QtProjects/GitHub/QtDB$
```

*Возникла ошибка, поскольку пользователи PostgreSQL создаются в нижнем регистре. Поэтому был создан пользователь ***capybara***, а не ***Capybara***.
Пока я искал ошибку, я изменил пароль пользователю ***Capybara*** на ***iamcapybara***. Теперь данные для аутентификации:*
```
   Login: capybara
Password: iamcapybara
```

*(После выяснилось, что для создания имени в верхнем регистре при вводе имени нужно использовать кавычки)*

После выполнения описанных шагов создан суперпользователь с правами на создание ролей и баз данных. От имени этого пользователя может вестись администрирование базы данных через графический интерфейс pgAdmin, запущенный на хостовой ОС.

---

Опишем требования к данным в таблицах

### owners_data

|                 | ID владельца                   | Фамилия                                                 | Имя            | Отчество               | Серия паспорта  | Номер паспорта  | Номер телефона                | Email                                       |
| --------------- | ------------------------------ | ------------------------------------------------------- | -------------- | ---------------------- | --------------- | --------------- | ----------------------------- | ------------------------------------------- |
| Формат данных   | Уникальное положительное число | Непустая строка (кириллица, дефисы, апострофы, пробелы) | --             | -- (может быть пустой) | 4 цифры         | 6 цифр          | "8" + 10 цифр (Уникальное)    | .!#$%&'*+-/=?^_`{}\|~@example.com уникально |
| Название в PSQL | **owner-id**                   | **last_name**                                           | **first_name** | **patronymic**         | **series_pass** | **number_pass** | **phone_nember**              | **email**                                   |

### cars_data

|                 | ID машины                      | Марка                                                          | Модель                                                                          | Цвет                                                          | Категория  | VIN                     | ID владельца     |
| --------------- | ------------------------------ | -------------------------------------------------------------- | ------------------------------------------------------------------------------- | ------------------------------------------------------------- | ---------- | ----------------------- | ---------------- |
| Формат данных   | Уникальное положительное число | Непустая строка (кириллица, латиница, пробелы, дефисы, скобки) | Непустая строка (кириллица, латиница, цифры, скобки, пробелы, дефисы, апостроф) |  Непустая строка (кириллица, латиница, цифры, пробелы, дефис) | [Из перечня](https://pddmaster.ru/vu/kategorii.html#:~:text=%D0%A0%D0%B0%D1%81%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%BA%D0%B0%20%D0%BA%D0%B0%D1%82%D0%B5%D0%B3%D0%BE%D1%80%D0%B8%D0%B9%20%D0%B2%D0%BE%D0%B4%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D0%BA%D0%B8%D1%85%20%D0%BF%D1%80%D0%B0%D0%B2%20%D0%BF%D1%80%D0%B8%D0%B2%D0%B5%D0%B4%D0%B5%D0%BD%D0%B0%20%D0%B2%C2%A0%D1%81%D0%BB%D0%B5%D0%B4%D1%83%D1%8E%D1%89%D0%B5%D0%B9%20%D1%82%D0%B0%D0%B1%D0%BB%D0%B8%D1%86%D0%B5%3A)| [17 символов](https://auto.ru/mag/article/identifikacionnyy-kod-kak-rasshifrovat-vin-avtomobilya/) | Присутствующий в owners_data ID влалельца|
| Название в PSQL | **car_id** | **car_mark** | **car_model** | **car_color** | **car_category** | **car_vin** | **owner_id** |

## Графический интерфейс

*вставить текст*